# 农场积分系统 - 测试指南

## 🧪 测试步骤

### 1. 测试农场跳转到积分页面

#### 步骤：
1. 打开 App，进入农场页面
2. 找到右侧的功能按钮区域
3. 点击"工分"按钮（第三个按钮）
4. 应该跳转到"我的账户"页面，并自动选中"可用积分" Tab

#### 预期结果：
- ✅ 页面顶部显示"我的账户"
- ✅ 显示当前可用积分余额
- ✅ "可用积分" Tab 被选中（红色背景）
- ✅ 显示积分明细列表
- ✅ 右上角显示"积分兑换消费券"按钮

### 2. 测试 Tab 切换

#### 步骤：
1. 在"我的账户"页面
2. 点击"仓库积分" Tab
3. 点击"消费券" Tab
4. 再次点击"可用积分" Tab

#### 预期结果：
- ✅ 每次切换 Tab 时，余额数字会更新
- ✅ 列表内容会刷新
- ✅ 选中的 Tab 显示红色背景，未选中显示灰色背景
- ✅ 兑换按钮文字会根据 Tab 变化

### 3. 测试积分兑换消费券

#### 步骤：
1. 在"我的账户"页面，选择"可用积分"或"仓库积分" Tab
2. 点击右上角"积分兑换消费券"按钮
3. 进入兑换页面后，输入兑换数量（例如：100）
4. 查看手续费和实际到账数量
5. 点击"全部兑换"按钮测试
6. 点击"兑换"按钮提交

#### 预期结果：
- ✅ 页面标题显示"积分兑换SWP"
- ✅ 显示当前可用积分数量
- ✅ 输入数量后，自动计算手续费和到账数量
- ✅ 点击"全部兑换"后，输入框自动填充所有可用积分
- ✅ 提交后显示"兑换成功"提示
- ✅ 返回账户页面后，余额已更新

### 4. 测试消费券兑换积分

#### 步骤：
1. 在"我的账户"页面，选择"消费券" Tab
2. 点击右上角"消费券兑换积分"按钮
3. 进入兑换页面后，输入兑换数量
4. 点击"全部兑换"按钮测试
5. 点击"兑换"按钮提交

#### 预期结果：
- ✅ 页面标题显示"SWP兑换积分"
- ✅ 显示当前可用消费券数量
- ✅ 输入数量后，显示实际到账数量
- ✅ 点击"全部兑换"后，输入框自动填充所有可用消费券
- ✅ 提交后显示"兑换成功"提示
- ✅ 返回账户页面后，余额已更新

### 5. 测试列表刷新

#### 步骤：
1. 在"我的账户"页面的列表区域
2. 下拉列表触发刷新
3. 滚动到列表底部，触发加载更多

#### 预期结果：
- ✅ 下拉时显示"下拉刷新"提示
- ✅ 松手后显示"刷新中..."
- ✅ 刷新完成后列表更新
- ✅ 上拉时显示"上拉加载"提示
- ✅ 加载完成后列表追加新数据
- ✅ 没有更多数据时显示"我也是有底线的"

### 6. 测试错误处理

#### 步骤：
1. 在兑换页面，不输入任何数量，直接点击"兑换"
2. 输入超过可用余额的数量，点击"兑换"
3. 输入小于 1 的数量，点击"兑换"

#### 预期结果：
- ✅ 未输入数量时，提示"请输入兑换数量"
- ✅ 超过余额时，提示"可用积分不足"或"可用SWP不足"
- ✅ 小于 1 时，提示"兑换数量最少1个"

## 🔍 检查清单

### UI 检查
- [ ] 顶部红色背景区域显示正常
- [ ] 余额数字使用 DIN Alternate 字体
- [ ] Tab 按钮圆角为 20px
- [ ] 选中的 Tab 背景色为 #FF5A5A
- [ ] 列表项之间有适当间距
- [ ] 收入显示红色，支出显示黑色

### 功能检查
- [ ] 农场"工分"按钮跳转正常
- [ ] Tab 切换数据更新正常
- [ ] 下拉刷新功能正常
- [ ] 上拉加载更多功能正常
- [ ] 积分兑换功能正常
- [ ] 消费券兑换功能正常
- [ ] 全部兑换功能正常
- [ ] 返回按钮功能正常

### 数据检查
- [ ] 用户余额显示正确
- [ ] 明细列表显示正确
- [ ] 时间格式显示正确
- [ ] 数量格式显示正确（保留两位小数）
- [ ] 收入/支出标识正确

### 性能检查
- [ ] 页面加载速度快
- [ ] 列表滚动流畅
- [ ] Tab 切换无卡顿
- [ ] 网络请求响应及时

## 🐛 常见问题排查

### 问题 1: 点击"工分"按钮没有反应
**排查步骤**:
1. 检查 `lib/app/modules/home/task_page.dart` 中的 `_handleButtonClick` 方法
2. 确认 `case 'points':` 分支存在
3. 检查路由 `AppRoutes.taskRyz` 是否正确配置

### 问题 2: 余额显示为 0
**排查步骤**:
1. 检查用户是否已登录
2. 检查 API 接口 `/user` 是否返回正确数据
3. 检查 `UserModel` 中的字段映射是否正确

### 问题 3: 列表不显示数据
**排查步骤**:
1. 检查 API 接口 `/fudou/list` 或 `/spread/commission/0` 是否返回数据
2. 检查网络请求是否成功
3. 查看控制台是否有错误日志

### 问题 4: 兑换失败
**排查步骤**:
1. 检查用户余额是否充足
2. 检查 API 接口 `/xfq_dui` 或 `/swp_dui` 是否正常
3. 检查请求参数格式是否正确

## 📱 测试设备建议

### iOS
- iPhone 12 及以上
- iOS 14.0 及以上

### Android
- Android 8.0 及以上
- 分辨率 1080x1920 及以上

## 🎯 测试重点

1. **跳转逻辑**: 确保从农场能正确跳转到积分页面
2. **数据准确性**: 确保余额和明细数据显示正确
3. **交互流畅性**: 确保 Tab 切换、列表滚动流畅
4. **兑换功能**: 确保兑换流程完整可用
5. **错误处理**: 确保各种异常情况都有友好提示

## ✅ 测试完成标准

- [ ] 所有测试步骤都通过
- [ ] 所有检查清单项都勾选
- [ ] 没有发现严重 Bug
- [ ] UI 显示与设计稿一致
- [ ] 功能与 uni-app 版本一致

## 📞 问题反馈

如果在测试过程中发现问题，请记录：
1. 问题描述
2. 复现步骤
3. 预期结果
4. 实际结果
5. 截图或录屏

---

**测试愉快！** 🎉
